<!doctype html>

<!--
showcases
https://jsfiddle.net/1zraut2e/
https://jsfiddle.net/gh/get/library/pure/highcharts/highcharts/tree/master/samples/highcharts/members/renderer-basic
https://jsfiddle.net/BlackLabel/z0ej46sr/
-->

<html lang="de">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Heatmap of missing files</title>
       
    <style>
        /*
        .highcharts-figure, .highcharts-data-table table {
            min-width: 360px; 
            max-width: 1000px;
            margin: 1em auto;
        }

        .highcharts-data-table table {
            font-family: Verdana, sans-serif;
            border-collapse: collapse;
            border: 1px solid #EBEBEB;
            margin: 10px auto;
            text-align: center;
            width: 100%;
            max-width: 500px;
        }
        .highcharts-data-table caption {
            padding: 1em 0;
            font-size: 1.2em;
            color: #555;
        }
        .highcharts-data-table th {
            font-weight: 600;
            padding: 0.5em;
        }
        .highcharts-data-table td, .highcharts-data-table th, .highcharts-data-table caption {
            padding: 0.5em;
        }
        .highcharts-data-table thead tr, .highcharts-data-table tr:nth-child(even) {
            background: #f8f8f8;
        }
        .highcharts-data-table tr:hover {
            background: #f1f7ff;
        }
        */

        /* https://codepen.io/paulobrien/pen/jAzkpY */

        html, body {
            margin:0;
            padding:0;
            height:100%
        }
        .wrap {
            position:relative;
            min-height:100%;
            background:none;
        }
        .abs {
            height:80%;
            background:none;
            position:absolute;
            left:0;
            right:0;
            top:0;
            bottom:0;
            margin:auto;
        }


        body { 
            font-family: "Gill Sans Extrabold", 
            Helvetica, sans-serif
        }


        table {border-collapse: collapse;}
        table tr td {color: grey;}
        td {
            padding: 0px;
            font-size: 80%
        }


        .center {
            margin-left: auto;
            margin-right: auto;
        }


        .button {
            background-color: #4CAF50; /* Green */
            border: none;
            color: white;
            padding: 10px 22px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 80%;
            margin: 4px 2px;
            cursor: pointer;
        }
        .button5 {
            background-color: white;
            color: rgb(180,180,180);
            border: 2px solid rgb(180,180,180);
        }
    </style>


       
</head>

<body>
           
    <!--
    place the heatmap and statistic
    -->
    <div class="wrap">
        <div class="abs">
        <figure class="highcharts-figure" style="max-width:1000px; margin-left: auto; margin-right: auto;">
        
            <div style="text-align:center; margin-bottom:8ex">
                <button onclick="toggleFunction()" class="button button5 center">Statistic view/hide</button>
            </div>
            <div id="myDIV" style="display:none">
      

                <table class="center">
                    <tr>
                        <td>created</td>
                        <td  style="text-align:right">2021-03-22</td>
                    </tr>
                    <tr>
                        <td>selected time interval</td>
                        <td  style="text-align:right">2019-03-10 - 2019-08-26</td>
                    </tr>
                    <tr>
                        <td>extented time interval</td>
                        <td  style="text-align:right">2019-03-04 - 2019-09-01</td>
                    </tr>
                    <tr>
                        <td>number of days on those files are missing</td>
                        <td  style="text-align:right">141 / 182</td>
                    </tr>
                    <tr>
                        <td>number of days on those no files are missing</td>
                        <td  style="text-align:right">21 / 182</td>
                    </tr>
                   
                </table>
            
            </div> 
            
            <div id="container"></div>
        </figure>
        </div>
    </div>
               
    <!--
    place data
    -->
    <pre id="csv" style="display: none">Date,Day of the week,Missing files
    201909,0,
    201909,1,
    201909,2,
    201909,3,
    201909,4,
    201909,5,
    201909,6,2.0
    201910,0,
    201910,1,
    201910,2,
    201910,3,
    201910,4,
    201910,5,
    201910,6,
    201911,0,
    201911,1,1.0
    201911,2,0.5
    201911,3,1.0
    201911,4,0.5
    201911,5,0.5
    201911,6,1.5
    201912,0,2.0
    201912,1,0.5
    201912,2,0.5
    201912,3,0.0
    201912,4,1.5
    201912,5,1.5
    201912,6,0.0
    201913,0,1.0
    201913,1,1.5
    201913,2,0.0
    201913,3,1.0
    201913,4,1.0
    201913,5,2.0
    201913,6,0.0
    201914,0,1.0
    201914,1,1.0
    201914,2,1.5
    201914,3,0.5
    201914,4,2.0
    201914,5,1.5
    201914,6,0.5
    201915,0,0.0
    201915,1,1.0
    201915,2,1.0
    201915,3,2.0
    201915,4,1.5
    201915,5,1.5
    201915,6,0.0
    201916,0,1.0
    201916,1,1.0
    201916,2,1.5
    201916,3,1.0
    201916,4,2.0
    201916,5,0.0
    201916,6,0.5
    201917,0,1.0
    201917,1,0.5
    201917,2,1.5
    201917,3,0.0
    201917,4,0.5
    201917,5,0.0
    201917,6,1.5
    201918,0,1.5
    201918,1,1.5
    201918,2,1.5
    201918,3,1.5
    201918,4,1.5
    201918,5,1.0
    201918,6,1.5
    201919,0,1.5
    201919,1,0.0
    201919,2,1.0
    201919,3,0.5
    201919,4,0.0
    201919,5,1.5
    201919,6,1.5
    201920,0,1.0
    201920,1,1.0
    201920,2,1.0
    201920,3,2.0
    201920,4,1.5
    201920,5,0.5
    201920,6,1.0
    201921,0,0.0
    201921,1,1.5
    201921,2,2.0
    201921,3,1.0
    201921,4,0.5
    201921,5,1.0
    201921,6,0.5
    201922,0,1.0
    201922,1,1.0
    201922,2,1.0
    201922,3,2.0
    201922,4,1.5
    201922,5,1.5
    201922,6,1.0
    201923,0,1.0
    201923,1,0.0
    201923,2,1.5
    201923,3,1.0
    201923,4,2.0
    201923,5,1.5
    201923,6,1.0
    201924,0,0.0
    201924,1,1.0
    201924,2,2.0
    201924,3,1.5
    201924,4,1.5
    201924,5,0.0
    201924,6,0.0
    201925,0,1.5
    201925,1,0.0
    201925,2,0.5
    201925,3,1.5
    201925,4,0.5
    201925,5,1.5
    201925,6,1.0
    201926,0,0.5
    201926,1,1.0
    201926,2,1.0
    201926,3,1.5
    201926,4,1.5
    201926,5,2.0
    201926,6,1.5
    201927,0,1.5
    201927,1,0.5
    201927,2,0.0
    201927,3,2.0
    201927,4,1.0
    201927,5,1.5
    201927,6,1.0
    201928,0,2.0
    201928,1,0.5
    201928,2,1.5
    201928,3,1.5
    201928,4,1.0
    201928,5,0.5
    201928,6,1.0
    201929,0,1.5
    201929,1,1.5
    201929,2,2.0
    201929,3,1.5
    201929,4,0.0
    201929,5,2.0
    201929,6,2.0
    201930,0,0.5
    201930,1,2.0
    201930,2,1.0
    201930,3,1.0
    201930,4,1.0
    201930,5,0.5
    201930,6,1.0
    201931,0,2.0
    201931,1,1.5
    201931,2,1.0
    201931,3,2.0
    201931,4,0.5
    201931,5,1.0
    201931,6,2.0
    201932,0,0.5
    201932,1,0.5
    201932,2,1.0
    201932,3,1.0
    201932,4,1.0
    201932,5,1.5
    201932,6,0.5
    201933,0,0.5
    201933,1,1.0
    201933,2,0.5
    201933,3,1.0
    201933,4,0.0
    201933,5,1.0
    201933,6,0.5
    201934,0,0.0
    201934,1,
    201934,2,
    201934,3,
    201934,4,
    201934,5,
    201934,6,
    
    </pre>


    <script src="https://code.highcharts.com/highcharts.js"></script>
    <script src="https://code.highcharts.com/modules/heatmap.js"></script>
    <script src="https://code.highcharts.com/modules/data.js"></script>
    <script src="https://code.highcharts.com/modules/exporting.js"></script>



    <!--
    create/prepare highcharts heatmap
    -->
    <script>
        var weekdays = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']
            
        
        
        // set labeldates ARRAY
        var labels123=[
        new Date(2019, 3-1, 4)
            ,
            new Date(2019, 3-1, 11)
            ,
            new Date(2019, 3-1, 18)
            ,
            new Date(2019, 3-1, 25)
            ,
            new Date(2019, 4-1, 1)
            ,
            new Date(2019, 4-1, 8)
            ,
            new Date(2019, 4-1, 15)
            ,
            new Date(2019, 4-1, 22)
            ,
            new Date(2019, 4-1, 29)
            ,
            new Date(2019, 5-1, 6)
            ,
            new Date(2019, 5-1, 13)
            ,
            new Date(2019, 5-1, 20)
            ,
            new Date(2019, 5-1, 27)
            ,
            new Date(2019, 6-1, 3)
            ,
            new Date(2019, 6-1, 10)
            ,
            new Date(2019, 6-1, 17)
            ,
            new Date(2019, 6-1, 24)
            ,
            new Date(2019, 7-1, 1)
            ,
            new Date(2019, 7-1, 8)
            ,
            new Date(2019, 7-1, 15)
            ,
            new Date(2019, 7-1, 22)
            ,
            new Date(2019, 7-1, 29)
            ,
            new Date(2019, 8-1, 5)
            ,
            new Date(2019, 8-1, 12)
            ,
            new Date(2019, 8-1, 19)
            ,
            new Date(2019, 8-1, 26)
            ]
        
        // create heatmap
        Highcharts.chart('container', {
        
            data: {
                csv: document.getElementById('csv').innerHTML
            },
        
            chart: {
                type: 'heatmap',
                width: 1000,
                height: 400,
                plotBorderWidth: 1,
                backgroundColor: 'rgba(255,2,255,0.01)',
        
                //events: {
                    
                //// custom text box
                    //render() {
                        //var chart = this
                        

                        //if (chart.customLabel) {
                            //chart.customLabel.destroy();
                        //}
                        //chart.customLabel = chart.renderer.label(
                            //'missed files : <b>' + 141 + '/' + 182 +'</b></br>' +
                            //'d: <b>'  + 21 + '/' + 182 + '</b></br>' +
                            //'selected    : '  + '<b>2019-03-10 - ' + '2019-08-26 </b></br>' +
                            //'created     : '  + '<b>2021-03-22' + '</b>'
                            //,
                            //700,0
                        //)
                        //.css({
                            //color: 'rgba(0,0,0,0.4)',
                            //fontSize: '11px',
                            //fontFamily:'mono',
                        //})
                        //.attr({
                            //fill: 'rgba(230, 230, 230, 0.05)',
                            ////border-color:'red',
                            //padding: 3,
                            //r: 5,
                            //zIndex: 6
                        //})
                        //.add();
                    
                    //}
                //}
            },
        
            boost: {
                useGPUTranslations: true
            },
        
            title: {
                text: 'Missing files',
                align: 'left',
                x: 60
            },
        
            subtitle: {
                text: 'doc/mypic_external_dataframe',
                align: 'left',
                x: 60
            },
        
            
            xAxis: {
                title: {
                  text: 'Time [week]'
                },
                categories: labels123,
                
                labels: {
                    formatter: function() {
                        if (this.isFirst) {
                            i = -1
                        }
                        i++;
                        return labels123[i].toLocaleString('default', { weekday:'long' }) + 
                        '<br/>' + labels123[i].toLocaleDateString('fr-CA')
                    },
                    step:4,
                    rotation: 0,
                },
            },
        
            yAxis: {
                title: {
                    text: 'Day of the week'
                },
                labels: {
                    format: '{value}'
                },
                minPadding: 0,
                maxPadding: 0,
                startOnTick: false,
                endOnTick: false,
                tickWidth: 1,
                min: 0,
                max: 6,
                reversed: false,
                categories: weekdays
            },
        
            colorAxis: {
                stops: [
                    [0, 'limegreen'],
                    [0.01, 'yellow'],
                    [0.50, 'orange'],
                    [1, 'red']
                ],
                min: 0,
                max: 1,
                reversed: false,
                categories: ['less','more'],
                
            },
            
            
            tooltip: {
                backgroundColor: 'rgba(250,250,250,0.95)',
                useHTML: true,
                formatter: function () {
                    return '<table>' +
                            '<tr><td>Year & week </td><td>' + this.point.x.toString().substring(0,4) + ' & ' + this.point.x.toString().substring(4,6) +'</td></tr>' +
                            '<tr><td>Day of week </td><td>' + weekdays[this.point.y] + '</td></tr>'+
                            '<tr><td>Missing value</td><td>' + this.point.value + '</td></tr>' +
                        '</table>';
                }
            },
        
            
            series: [{
                nullColor: 'rgb(255, 255, 255)',
                borderColor: 'rgba(250,250,250,0.9)',
                borderWidth: 3,
        
            }],
            
            legend: {
                align: 'right',
                layout: 'vertical',
                margin: 5,
                verticalAlign: 'top',
                y: 80,
                symbolHeight: 200
            },
            
        
        });
        
        
        function toggleFunction() {
            var x = document.getElementById("myDIV");
            if (x.style.display === "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        } 
        
    </script>

</body>
</html>